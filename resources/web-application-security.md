# Web Application Security

## What is OWASP (Open Web Application Security Project)?

The OWASP Top 10 is a list of the most critical web application security risks, including issues like SQL injection, broken authentication, cross-site scripting (XSS), and more. It helps organizations identify and mitigate common vulnerabilities in web applications.

1. Injection
2. Broken Authentication
3. Sensitive Data Exposure
4. XML External Entities (XXE)
5. Broken Access Control
6. Security Misconfiguration
7. Cross-Site Scripting (XSS)
8. Insecure Deserialization
9. Using Components With Known Vulnerabilities
10. Insufficient Logging And Monitoring

## What is SQL injection, and how can it be prevented?

SQL injection is an attack where user's inputs (malicious SQL queries) are treated as commands and executed by the database.

Prevention

- Use parameterized queries
- Validate and sanitize inputs
- Escape special characters
- Use Object-Relational Mapping (ORM) tools

## Describe an attack you’ve learned about (e.g., Cross-Site Scripting, Cross-Site Request Forgery) and how to defend against it

Cross-Site Scripting (XSS) occurs when an attacker injects malicious scripts into webpages viewed by other users.

- Reflected XSS
- Stored XSS
- DOM XSS

Prevention

- Sanitize and escape user inputs
- Use content security policies (CSP)
- Implement httpOnly and secure flags on cookies

CSRF attack will not be required if you can do XSS - stronger.

## JWT vs CSRF Tokens

### JWT (JSON Web Token)

- Used primarily for authentication and authorisation
- Proves the identity of the user and carry information about them
- Use case -> Grant access to protected resources

### Structure of JWT

- Header.Payload.Signature
- Header: Contains metadata about the token, signing algorithm and token type

```
{
  "alg": "HS256",
  "typ": "JWT"
}
```

- Payload: Contains the claims or data being transmitted (userId, role)

```
{
  "sub": "1234567890",
  "name": "John Doe",
  "iat": 1516239022
}
```

- Signature: Ensures the token hasn't been tampered with, this is generated by hashing the header and payload using a secret key (HMAC algorithms) or a private key (asymmetric algorithms)

### How does JWT work?

- Client logins and authenticated by the server
- Server generates a JWT token and sends it to the client
- Client stores the token (local storage, session storage, cookies). Best stored in HttpOnly cookies to prevent XSS.
- Client includes this token in the Authorization header of each API request. `Authorization: Bearer <token>`
- Server validates the token's signature, checks the expiry and verifies other claims

### CSRF Token

- Used to prevent Cross-Site Request Forgery (CSRF) attacks.
- Ensures that requests sent to a server are made intentionally by the authenticated user and not by a malicious actor.

### How does CSRF token work?

- A unique, random token is generated by the server and sent to the client as part of the API response.
- The token must be sent back with subsequent requests, often in a hidden field.
- The server validates the token to ensure the request is genuine.

## Describe a situation where you detected a security vulnerability and how you addressed it

During a vulnerability assessment of a web application, I discovered that the site was vulnerable to SQL injection attacks because user inputs weren’t properly sanitized. I immediately reported the issue to the development team. Together, we implemented input validation and used prepared statements in SQL queries to prevent injection attacks. Additionally, we ran further tests and updated the codebase to ensure the issue didn’t recur.

**Key Actions**

- Detection: Identifying the vulnerability through automated scans or manual testing.
- Mitigation: Collaborating with the team to implement a solution (in this case, sanitizing inputs and using secure coding practices).
- Follow-up: Verifying that the vulnerability was effectively addressed and adding further layers of security.

## What are the best practices for securely storing passwords?

- Never store passwords in plaintext.
- Hash passwords using strong algorithms like bcrypt or Argon2.
- Use salts to prevent attacks like rainbow table lookups.
- Implement a password policy to enforce complexity and rotation.

## Can you explain what XSS (Cross-Site Scripting) is and how to prevent it in web applications?

- Cross-site scripting is an attack that injects malicious code into web pages.
- 3 types of XSS, reflected, stored and DOM-based XSS.
  - Reflected and stored XSS involves the server while DOM-based XSS involves only the client.
  - XSS can be prevented by validating and sanitizing user inputs so that they are not treated as codes, using security headers like `Content-Security-Policy` or using httpOnly flag to prevent JavaScript from accessing the cookie.

## What is a Zero-Day vulnerability? Can you provide an example of how it can be exploited?

A Zero-Day vulnerability is a previously unknown security flaw that attackers can exploit before the vendor becomes aware of releases fix for it. Example: The EternalBlue exploit, which targeted a Windows SMB vulnerability, was leveraged in ransomware attacks like WannaCry.

## Zero Trust Security

Assumes no one, whether inside or outside the organization should be trusted by default. Never trust, and always verify. Cyber attacks can happen from both internal/external, every request to the system should be verified.

## CSRF Attacks

- Forged requests on behalf of a logged-in user
- Use CSRF tokens, SameSite cookies

## Security Tools

- Static Application Security Testing (SAST)
  - SonarQube
- Dynamic Application Security Test (DAST)
  - OWASP Zap
  - Burp Suite

## Policy

Same Site Origin Policy
CORS

## Secure Coding Practices

Write software in a way that protects against security vulnerabilities and ensures CIA is fulfilled.

1. Input validation
   - Validate all inputs on server side
   - Only allow digits for phone number, not text
   - Use regular expressions to validate inputs
   - Treat all user inputs as untrusted and sanitize them
2. Output encoding
   - Data displayed to user is not executed as code, to prevent XSS
     - Convert special characters `> < & "` to HTML entities (`&lt, &gt`)
     - URL encoding
     - JavaScript and CSS encoding
3. Use parameterized queries for database access to prevent SQL injections
   - No concatenation to form SQL queries
   - Parameterized queries ensure that user input is treated as data, and not executable code
4. Authentication (Prove who you are) and Authorization (Access control)
   - Hash password using strong algorithms like bcrypt
   - Add salt to prevent 2 same passwords from having the same digest, and to prevent rainbow table attacks
   - Implement MFA to add extra layer of security
   - Implement RBAC to ensure users only have access to the resources they need
   - Ensure that authentication tokens (sessionID, JWTs) are securely stored and transmitted only via HTTPS to prevent eavesdropping
5. Secure Communication
   - To prevent man-in-the-middle attacks, and avoid exposing sensitive data -> always use HTTPS (SSL/TLS) to encrypt data that is transmitted over the network
   - Use latest secure version of TLS
6. Use Strong Cryptography
   - Weak cryptography can allow attackers to easily decrypt sensitive information/tamper with it
   - Use modern cryptographic algorithms (AES-256, RSA-2048)
   - Use salt for hashing passwords and keys
   - Never hard-code sensitive keys or cryptographic secrets in the source code
   - For symmetric encryption use secure key management system to protect the keys
7. Security Headers
   - Set Content-Security-Policy (CSP) headers to control which resources can be loaded on the site

## Scenarios

**Cross-Site Scripting (XSS) Attack**

A user submits a comment on a blog page, and the content is displayed without any validation or sanitization. The comment includes a malicious script that, when viewed by other users, sends their session cookies to an attacker’s server.

How would you prevent this type of attack?

Explain input sanitization (e.g., using libraries like OWASP Java HTML Sanitizer), Content Security Policy (CSP), and using HTTPOnly and Secure flags for cookies.

**SQL Injection**

An application allows users to search for products by entering a search query. The application directly inserts the user input into an SQL query without proper sanitization, leading to a potential SQL injection vulnerability. An attacker inputs ' OR 1=1 -- into the search box and gains access to sensitive data.

How would you defend against SQL injection attacks?

Use prepared statements, parameterized queries, and ORM frameworks to prevent direct interaction between user input and SQL queries.

**Cross-Site Request Forgery (CSRF)**

A user is logged into a banking website. The attacker sends a link via email, tricking the user into clicking on it. The link causes an unintended money transfer from the user’s account to the attacker’s account.

How can you mitigate CSRF risks in a web application?

Implement anti-CSRF tokens, ensure that sensitive actions are protected by POST methods, and use SameSite cookie attributes to prevent cookies from being sent with cross-origin requests.

**Insecure Direct Object References (IDOR)**

A user can modify the URL in their browser to access another user’s data (e.g., changing user=123 to user=124 to view another user’s private profile).

How would you address IDOR vulnerabilities?

Use proper authorization checks on the server side to ensure users can only access resources they’re permitted to, even if the object references in the URL are manipulated.

**Session Fixation Attack**

An attacker forces a victim to use a specific session ID by embedding it in a URL. After the victim logs in with that session ID, the attacker can hijack the session and perform malicious actions on their behalf.

How would you mitigate session fixation attacks?

Regenerate session IDs after login and use secure cookie flags (Secure, HttpOnly, SameSite). Enforce strong session management practices.

**Broken Authentication and Session Management**

The application uses weak passwords and does not properly invalidate sessions when a user logs out. An attacker exploits this by reusing an old session cookie to impersonate the user.

What steps would you take to improve authentication and session management?

Implement multi-factor authentication (MFA), enforce strong password policies, use proper session expiration, and ensure session tokens are securely stored.

**Security Misconfiguration**

A web application’s production environment is running with default configurations, revealing sensitive error messages and exposing internal files that should not be publicly accessible.

How would you address security misconfiguration issues?

Regularly audit and harden configurations, disable unnecessary services, and avoid default settings. Use error handling that does not expose sensitive information to users.

**Sensitive Data Exposure**

A web application stores user credit card information in plain text in the database. An attacker gains access to the database and retrieves sensitive user data.

What actions would you take to prevent sensitive data exposure?

Implement encryption (both at rest and in transit), tokenize sensitive data, and follow the principles of least privilege for access control.
